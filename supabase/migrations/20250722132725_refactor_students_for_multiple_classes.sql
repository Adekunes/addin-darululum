-- 1. Drop the join table\nDROP TABLE IF EXISTS public.class_enrollments;\n\n-- 2. Add class_ids array to the students table\nALTER TABLE public.students ADD COLUMN IF NOT EXISTS class_ids UUID[];\n\n-- 3. Create a function to add a class to multiple students\nCREATE OR REPLACE FUNCTION append_class_to_students(student_ids_to_update UUID[], class_id_to_add UUID)\nRETURNS void AS 442\nBEGIN\n  UPDATE public.students\n  SET class_ids = array_append(class_ids, class_id_to_add)\n  WHERE id = ANY(student_ids_to_update);\nEND;\n442 LANGUAGE plpgsql;\n\n-- 4. Create a function to remove a class from a single student\nCREATE OR REPLACE FUNCTION remove_class_from_student(student_id_to_update UUID, class_id_to_remove UUID)\nRETURNS void AS 442\nBEGIN\n  UPDATE public.students\n  SET class_ids = array_remove(class_ids, class_id_to_remove)\n  WHERE id = student_id_to_update;\nEND;\n442 LANGUAGE plpgsql;
